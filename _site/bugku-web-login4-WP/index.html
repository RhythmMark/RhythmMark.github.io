<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>【CBC字节翻转】三文鱼都能看懂的bugku-web-login4-WP – Rhy7hm</title> <meta name="description" content="天天被计算机教做人"> <meta name="keywords" content="CBC 字节翻转攻击, bugku, web, Crypto, CTF, Write up, 三文鱼"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="http://www.nsoad.com/upload/20161014/d6804a98376fedd714d6e578aa6c7e14.png"> <meta name="twitter:title" content="【CBC字节翻转】三文鱼都能看懂的bugku-web-login4-WP"> <meta name="twitter:description" content="如题"> <!-- Open Graph --> <meta property="og:locale" content="zh_CN"> <meta property="og:type" content="article"> <meta property="og:title" content="【CBC字节翻转】三文鱼都能看懂的bugku-web-login4-WP"> <meta property="og:description" content="如题"> <meta property="og:url" content="http://localhost:4000/bugku-web-login4-WP/"> <meta property="og:site_name" content="Rhy7hm"> <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"> <link rel="canonical" href="http://localhost:4000/bugku-web-login4-WP/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Rhy7hm Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png"> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <style type="text/css">.feature {background-image:url(http://www.nsoad.com/upload/20161014/d6804a98376fedd714d6e578aa6c7e14.png);}</style> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/logo.png" alt="Rhy7hm photo" class="author-photo"> <h4>Rhy7hm</h4> <p>天天被计算机教做人</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:rhythmm.mark@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://github.com/RhythmMark" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://stackoverflow.com/users/9682814/rhy7hm" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-stack-overflow"></i> StackOverflow</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://localhost:4000/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title feature "> <h1>【CBC字节翻转】三文鱼都能看懂的bugku-web-login4-WP</h1> <h4>23 Apr 2018</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~4 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="三文鱼都能看懂的cbc字节翻转d">三文鱼都能看懂的CBC字节翻转:D</h1> <hr> <p><strong>代码审计之前</strong></p> <p>这是在<a href="http://ctf.bugku.com/challenges">bugku</a>里web分类中的最后一道题。 打开就看到一个连接和一个hint，hint说是<code class="highlighter-rouge">CBC字节翻转攻击</code>。 <img src="http://chuantu.biz/t6/293/1524449476x-1566661211.png" alt=""></p> <p>我们先用SourceLeakHacker扫一下，SourceLeakHacker是一款敏感目录扫描工具，敏感目录扫描是web~~狗~~手的常用姿势之一。 <img src="http://chuantu.biz/t6/293/1524481869x-1566661211.png" alt=""></p> <p>看到那个绿色的200表示能够成功访问，这就是我们扫出来的敏感路径</p> <p>我们这里要用到的是.index.php.swp这个文件</p> <p>我们不用很麻烦就能通过<a href="https://www.google.com/">搜索引擎</a>知道这个文件是非正常关闭vi编辑器时生成的。</p> <p>我们访问这个url，就能成功下载这个文件。 <img src="http://chuantu.biz/t6/293/1524481905x-1566661211.png" alt=""> 这个文件是需要恢复的。恢复方法如下： 将文件拖入虚拟机，在文件所在的目录（下图的第一条指令）使用</p> <p><code class="highlighter-rouge">vi -r index.php.swp</code></p> <p>这条命令 <img src="http://chuantu.biz/t6/293/1524481976x-1566661211.png" alt=""> 然后会出来这个样子的 <img src="http://chuantu.biz/t6/293/1524482000x-1566661211.png" alt=""></p> <p>那它说Press ENTER or type command to continue就按个enter呗</p> <p>然后就出来我们需要的代码了 <img src="http://chuantu.biz/t6/293/1524482024x-1566661211.png" alt=""> 这时Esc进入命令模式<del>其实不按也行，因为本来就在命令模式，这也是个人习惯吧</del></p> <p>敲 <code class="highlighter-rouge">:w index.php</code></p> <p>把还原出来的php文件另存为 index.php <img src="http://chuantu.biz/t6/293/1524482388x-1566661211.png" alt=""> 然后它会说index.php成功保存了</p> <p>再敲 <code class="highlighter-rouge">:q!</code></p> <p>退出编辑器</p> <p><del>把生成的文件拖回Windows</del></p> <p>然后就可以开始看代码了</p> <hr> <p><strong>PHP代码审计进行时</strong></p> <p>拔出来的代码如下</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"Content-Type"</span> <span class="na">content=</span><span class="s">"text/html; charset=utf-8"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;title&gt;</span>Login Form<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"static/css/style.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"static/js/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">$</span><span class="p">(</span><span class="s2">".username"</span><span class="p">).</span><span class="nx">focus</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">$</span><span class="p">(</span><span class="s2">".user-icon"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"left"</span><span class="p">,</span><span class="s2">"-48px"</span><span class="p">);</span>
	<span class="p">});</span>
	<span class="nx">$</span><span class="p">(</span><span class="s2">".username"</span><span class="p">).</span><span class="nx">blur</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">$</span><span class="p">(</span><span class="s2">".user-icon"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"left"</span><span class="p">,</span><span class="s2">"0px"</span><span class="p">);</span>
	<span class="p">});</span>

	<span class="nx">$</span><span class="p">(</span><span class="s2">".password"</span><span class="p">).</span><span class="nx">focus</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">$</span><span class="p">(</span><span class="s2">".pass-icon"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"left"</span><span class="p">,</span><span class="s2">"-48px"</span><span class="p">);</span>
	<span class="p">});</span>
	<span class="nx">$</span><span class="p">(</span><span class="s2">".password"</span><span class="p">).</span><span class="nx">blur</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">$</span><span class="p">(</span><span class="s2">".pass-icon"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"left"</span><span class="p">,</span><span class="s2">"0px"</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="cp">&lt;?php</span>
<span class="nb">define</span><span class="p">(</span><span class="s2">"SECRET_KEY"</span><span class="p">,</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'/root/key'</span><span class="p">));</span>

<span class="nb">define</span><span class="p">(</span><span class="s2">"METHOD"</span><span class="p">,</span> <span class="s2">"aes-128-cbc"</span><span class="p">);</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="k">function</span> <span class="nf">get_random_iv</span><span class="p">(){</span>
    <span class="nv">$random_iv</span><span class="o">=</span><span class="s1">''</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="nv">$random_iv</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">255</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$random_iv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">login</span><span class="p">(</span><span class="nv">$info</span><span class="p">){</span>
    <span class="nv">$iv</span> <span class="o">=</span> <span class="nx">get_random_iv</span><span class="p">();</span>
	<span class="c1">#初始向量</span>
    <span class="nv">$plain</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$info</span><span class="p">);</span>
	<span class="c1">#info序列化后得到明文</span>
    <span class="nv">$cipher</span> <span class="o">=</span> <span class="nb">openssl_encrypt</span><span class="p">(</span><span class="nv">$plain</span><span class="p">,</span> <span class="nx">METHOD</span><span class="p">,</span> <span class="nx">SECRET_KEY</span><span class="p">,</span> <span class="nx">OPENSSL_RAW_DATA</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>
	<span class="c1">#CBC模式下AES的加密明文</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'username'</span><span class="p">];</span>
    <span class="nb">setcookie</span><span class="p">(</span><span class="s2">"iv"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$iv</span><span class="p">));</span>
	<span class="c1">#初始向量经过base64加密</span>
    <span class="nb">setcookie</span><span class="p">(</span><span class="s2">"cipher"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$cipher</span><span class="p">));</span>
	<span class="c1">#45行出来的密文再加一层base64加密</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">check_login</span><span class="p">(){</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'cipher'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'iv'</span><span class="p">])){</span>
        <span class="nv">$cipher</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'cipher'</span><span class="p">]);</span>
        <span class="nv">$iv</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">"iv"</span><span class="p">]);</span>
		<span class="c1">#base64解密</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$plain</span> <span class="o">=</span> <span class="nb">openssl_decrypt</span><span class="p">(</span><span class="nv">$cipher</span><span class="p">,</span> <span class="nx">METHOD</span><span class="p">,</span> <span class="nx">SECRET_KEY</span><span class="p">,</span> <span class="nx">OPENSSL_RAW_DATA</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">)){</span>
			<span class="c1">#aes解密</span>
            <span class="nv">$info</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$plain</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">"&lt;p&gt;base64_decode('"</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$plain</span><span class="p">)</span><span class="o">.</span><span class="s2">"') can't unserialize&lt;/p&gt;"</span><span class="p">);</span>
			<span class="c1">#判断是否能成功反序列化</span>
            <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">'username'</span><span class="p">];</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">"ERROR!"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">show_homepage</span><span class="p">(){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span><span class="o">===</span><span class="s1">'admin'</span><span class="p">){</span>
		<span class="c1">#这里可以get flag</span>
		<span class="c1">#可见我们的session里的username必须要是admin</span>
        <span class="k">echo</span> <span class="s1">'&lt;p&gt;Hello admin&lt;/p&gt;'</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">'&lt;p&gt;Flag is $flag&lt;/p&gt;'</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'&lt;p&gt;hello '</span><span class="o">.</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]</span><span class="o">.</span><span class="s1">'&lt;/p&gt;'</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">'&lt;p&gt;Only admin can see flag&lt;/p&gt;'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">'&lt;p&gt;&lt;a href="loginout.php"&gt;Log out&lt;/a&gt;&lt;/p&gt;'</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">])){</span>
    <span class="nv">$username</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">];</span>
    <span class="nv">$password</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$username</span> <span class="o">===</span> <span class="s1">'admin'</span><span class="p">){</span>
		<span class="c1">#如果username是admin的话，就会显示下面这句话然后退出</span>
        <span class="k">exit</span><span class="p">(</span><span class="s1">'&lt;p&gt;admin are not allowed to login&lt;/p&gt;'</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nv">$info</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'username'</span><span class="o">=&gt;</span><span class="nv">$username</span><span class="p">,</span><span class="s1">'password'</span><span class="o">=&gt;</span><span class="nv">$password</span><span class="p">);</span>
        <span class="nx">login</span><span class="p">(</span><span class="nv">$info</span><span class="p">);</span>
        <span class="nx">show_homepage</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"username"</span><span class="p">])){</span>
		<span class="c1">#如果password为空</span>
        <span class="nx">check_login</span><span class="p">();</span>
        <span class="nx">show_homepage</span><span class="p">();</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'&lt;body class="login-body"&gt;
                &lt;div id="wrapper"&gt;
                    &lt;div class="user-icon"&gt;&lt;/div&gt;
                    &lt;div class="pass-icon"&gt;&lt;/div&gt;
                    &lt;form name="login-form" class="login-form" action="" method="post"&gt;
                        &lt;div class="header"&gt;
                        &lt;h1&gt;Login Form&lt;/h1&gt;
                        &lt;span&gt;Fill out the form below to login to my super awesome imaginary control panel.&lt;/span&gt;
                        &lt;/div&gt;
                        &lt;div class="content"&gt;
                        &lt;input name="username" type="text" class="input username" value="Username" onfocus="this.value=\'\'" /&gt;
                        &lt;input name="password" type="password" class="input password" value="Password" onfocus="this.value=\'\'" /&gt;
                        &lt;/div&gt;
                        &lt;div class="footer"&gt;
                        &lt;input type="submit" name="submit" value="Login" class="button" /&gt;
                        &lt;/div&gt;
                    &lt;/form&gt;
                &lt;/div&gt;
            &lt;/body&gt;'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div> <p>我个人习惯是先看flag在哪，然后看怎么才能到达这个地方，</p> <p><del>但是某不愿意透露姓名的web大佬是习惯从入口开始看的，和我刚好相反。</del></p> <p><del>（以下纯属个人做法，参考一下就好，想要更厉害的代码审计方法可以去py一下其他web大佬）</del></p> <p>Ctrl+F搜flag <img src="http://chuantu.biz/t6/293/1524482595x-1566661211.png" alt=""> 看到在show_homepage()这个函数里，$_SESSION[“username”]===’admin’的话我们就能get flag了</p> <p>那么哪里用到show_homepage()呢？有两个地方</p> <p>第一个是 <img src="http://chuantu.biz/t6/293/1524482636x-1566661211.png" alt=""> 此时username和password都有post，而且username不能为admin，那么经过login函数之后，就会运行到show_homepage()了。</p> <p>我们看看login干了啥 <img src="http://chuantu.biz/t6/293/1524482701x-1566661211.png" alt=""></p> <p><del>意思意思画个不规范的流程图</del> <img src="http://chuantu.biz/t6/293/1524482912x-1566661211.png" alt=""></p> <p>这里我们注意到最后一步， <code class="highlighter-rouge">$_SESSION['username'] = $info['username']</code></p> <p>而根据info的定义赋值可知，<code class="highlighter-rouge">$info['username']</code>是我们传进进去的账户名的值。</p> <p>但是由第93-95行代码可知，如果我们穿进去的账户名值为username，就会在一开始直接返回admin are not allowed to login然后退出，所以此路不通。</p> <p>幸好用到show_homepage()的还有另一个地方。 <img src="http://chuantu.biz/t6/293/1524482931x-1566661211.png" alt=""> 首先要不进入刚刚的那个if，就是不满足 <code class="highlighter-rouge">set($_POST['username']) &amp;&amp; isset($_POST['password'])</code> 然后，要有$_SESSION[“username”]在</p> <p>然后我们看看check_login()干了啥 <img src="http://chuantu.biz/t6/293/1524483429x-1566661211.png" alt=""> 其实就是相当于把login逆了过来而已。</p> <p>在正常情况下，如果我们正正经经地post一个账户名和口令字，这个网页就会把你post的东西经过login那一系列的变化，用cookie保存下来，然后下次我们不需要再post东西了，凭借cookie，网站通过check_login得到我们post过得账户名和口令字，就能知道我们的身份。</p> <p>这样经过check_login函数之后，<code class="highlighter-rouge">$_SESSION['username']</code>就还是我们最开始post的那个username。</p> <p>但我们是正经人吗？我们是要<del>搞事</del>get flag的人，所以我们就要想如何把<code class="highlighter-rouge">$_SESSION['username']</code>变成<code class="highlighter-rouge">admin</code>，</p> <p>即使我们最开始post的可能是admi2，</p> <p>但是它经过了AES加密和解密阿，这就有得搞了阿。</p> <p>这里就要用到hint里面提到的CBC字节翻转攻击</p> <p>攻击的point就在·check_login()·的解密过程里。</p> <p><del>PHP代码审计终于结束，可喜可贺可喜可贺</del></p> <p>什么是加密模式就不多说了，下面直接</p> <hr> <p><strong>CBC加密模式介绍</strong> <img src="http://chuantu.biz/t6/293/1524483577x-1566661211.png" alt=""> CBC它，就是每个明文块先与前一个密文块进行异或后，再进行加密 <img src="http://chuantu.biz/t6/293/1524483624x-1566661211.png" alt=""> 详细一点表达加密过程，就是</p> <p>当</p> <p>P是明文，C是密文，下标表示第几组EK是加密，DK是解密，IV是初始向量，Z就是个用来辅助的</p> <p>另</p> <p>Z1 = P1 ⊕ IV</p> <p>Z2 = P2 ⊕ C1</p> <p>Z3 = P3 ⊕ C2</p> <p>…</p> <p>Zi = Pi ⊕ Ci-1</p> <p>… 然后密文就是</p> <p>C0 = IV</p> <p>C1 = EK(Z1)</p> <p>C2 = EK(Z2)</p> <p>…</p> <p>Ci = EK(Zi)</p> <p>…</p> <p>以上都是为了更好地理解</p> <p><strong>加密 ↓</strong></p> <p>Ci = EK(Pi⊕Ci-1)</p> <p>所以</p> <p>Pi ⊕ Ci-1 = DK(Ci)</p> <p>Pi = DK(Ci) ⊕ Ci-1 <strong>&lt;-解密</strong></p> <p><del>word里面辛辛苦苦做下标，改成.md一朝回到解放前</del></p> <p>所以，我们可以通过修改Ci-1来达到修改Pi的目的</p> <p>我们先来看一下CBC字节翻转攻击是怎么做的</p> <p>这里直接引用<a href="http://cb.drops.wiki/drops/tips-7828.html">这里</a> 提到的一个例子</p> <p><del>刚发现链接好像打不开了？？？？</del></p> <hr> <p>【复制粘贴开始】</p> <p>比方说，我们有这样的明文序列：</p> <p>a:2:{s:4:”name”;s:6:”sdsdsd”;s:8:”greeting”;s:20:”echo ‘Hello sdsdsd!’”;}</p> <p>我们的目标是将“s:6”当中的数字6转换成数字“7”。我们需要做的第一件事就是把明文分成16个字节的块：</p> <p>• Block 1:a:2:{s:4:”name”;</p> <p>• Block 2:s:6:”sdsdsd”;s:8</p> <p>• Block 3::”greeting”;s:20</p> <p>• Block 4::”echo ‘Hello sd</p> <p>• Block 5:sdsd!’”;}</p> <p>因此，我们的目标字符位于块2，这意味着我们需要改变块1的密文来改变第二块的明文。</p> <p>有一条经验法则是（注：结合上面的说明图可以得到），你在密文中改变的字节，只会影响到在下一明文当中，具有相同偏移量的字节。所以我们目标的偏移量是2：</p> <p>• [0] = s</p> <p>• 1 = :</p> <p>• 2 =6</p> <p>因此我们要改变在第一个密文块当中，偏移量是2的字节。正如你在下面的代码当中看到的，在第2行我们得到了整个数据的密文，然后在第3行中，我们改变块1中偏移量为2的字节，最后我们再调用解密函数。</p> <ol> <li> <p><code class="highlighter-rouge">$v = "a:2:{s:4:"name";s:6:"sdsdsd";s:8:"greeting";s:20:"echo 'Hello sdsdsd!'";}";</code></p> </li> <li> <p><code class="highlighter-rouge">$enc = @encrypt($v);</code></p> </li> <li> <p><code class="highlighter-rouge">$enc[2] = chr(ord($enc[2]) ^ ord("6") ^ ord ("7"));</code></p> </li> <li> <p><code class="highlighter-rouge">$b = @decrypt($enc);</code></p> </li> </ol> <blockquote> </blockquote> <p>运行这段代码后，我们可以将数字6变为7：</p> <p>但是我们在第3行中，是如何改变字节成为我们想要的值呢？</p> <p>基于上述的解密过程，我们知道有，A = Decrypt(Ciphertext)与B = Ciphertext-N-1异或后最终得到C = 6。等价于：</p> <p>C = A XOR B</p> <p>所以，我们唯一不知道的值就是A（注：对于B，C来说）（block cipher decryption）;借由XOR，我们可以很轻易地得到A的值：</p> <p>A = B XOR C</p> <p>最后，A XOR B XOR C等于0。有了这个公式，我们可以在XOR运算的末尾处设置我们自己的值，就像这样：</p> <p>A XOR B XOR C XOR “7”会在块2的明文当中，偏移量为2的字节处得到7。</p> <p>【复制粘贴结束】</p> <hr> <p>然后回到我们这一题。</p> <p>我们的明文序列是：</p> <p><code class="highlighter-rouge">a:2:{s:8:"username";s:5:"admi2";s:8:"password";s:8:"Password";}</code></p> <p>wait a minute ……这个明文序列怎么来的?</p> <p>这是因为，我们知道：</p> <p><code class="highlighter-rouge">$info = array('username'=&gt;$username,'password'=&gt;$password);</code></p> <p>我们可以用</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$info</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'username'</span><span class="o">=&gt;</span><span class="s1">'admi2'</span><span class="p">,</span><span class="s1">'password'</span><span class="o">=&gt;</span><span class="s1">'Password'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$info</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div> <p>开个phpstudy localhost访问一下就能得到上面那个明文序列</p> <p>然后</p> <p>我们也分个块</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a:2:{s:8:"userna
me";s:5:"admi2";
s:8:"password";s
:8:"Password";}
</code></pre></div></div> <p>我们要改的是admi2中的’2’，也就是第二列的第13个</p> <p><del>插一段黑历史 请不要像我一样数的时候没数到python框住字符串的单引号以为第二行的”就是结束谢谢</del></p> <p><img src="http://chuantu.biz/t6/293/1524484373x-1566661211.png" alt=""></p> <p><del>get 不到？我当年是从上图第三行那里数出来’2’在倒数第二个也就是排15的……</del></p> <p>按照CBC字节翻转攻击的套路，我们要修改的是上一个分组对应位置的密文</p> <p>就是下面会放的脚本中的代码：</p> <p><code class="highlighter-rouge">bs_de[13]=chr(ord(bs_de[13]) ^ ord('2') ^ ord('n'))</code></p> <p>也就是，如果crypto是我们那个明文序列经过aes加密后的密文</p> <p>只要我们令</p> <p><strong>crypto[13] = crypto[13] ⊕ ‘2’ ⊕ ‘n’</strong></p> <p>即，把第一个分组的第13个字符（因为我们要改的是第二个分组中的第13个字符），变成</p> <p><strong>crypto[13] ⊕ ‘2’ ⊕ ‘n’</strong></p> <p>其实就是: <code class="highlighter-rouge">密文 ⊕ 我们要改掉的 ⊕ 我们要改成的</code></p> <p>我们看看解密的时候会发生什么？</p> <p>我们知道，解密是Pi = DK(Ci) ⊕ Ci-1</p> <p>我们把crypto[13]，也就是上式的Ci-1改了</p> <p>当i= 2 时</p> <p>Pi = DK(Ci) ⊕ Ci-1 = DK(Ci) ⊕ crypto[13] ⊕ ‘2’ ⊕ ‘n’</p> <p>而我们又有</p> <p>Pi = DK(Ci) ⊕ Ci-1</p> <p>Pi ⊕ DK(Ci) ⊕ Ci-1 = 0</p> <p><em>异或其实就是二进制里面的加法，而且相同的相加为零，这式子相当于两边同时加Pi</em></p> <p>DK(Ci) ⊕ Ci-1 ⊕ Pi = 0</p> <p>DK(Ci)[13] ⊕ Ci-1 [13]⊕ Pi [13]= 0</p> <p>DK(Ci) ⊕ crypto[13] ⊕ ‘2’ = 0</p> <p>DK(Ci) ⊕ crypto[13] ⊕ ‘2’ ⊕ ‘n’ = ‘n’</p> <p>Pi = DK(Ci) ⊕ Ci-1 = DK(Ci) ⊕ crypto[13] ⊕ ‘2’ ⊕ ‘n’ = ‘n’</p> <p><strong>         ↑这里check_login在解密的时候就这么做，和DK(Ci)异或</strong></p> <p><strong>                         ↑这是我们修改了的密文</strong></p> <p><strong>↑这是check_login 解密之后产生的明文</strong></p> <p>综上，只要我们把第一组密文改一改，就能让它解密之后第二组的明文产生变化。</p> <p>我们再回到这道题</p> <table> <thead> <tr> <th>Login函数中</th> <th style="text-align: left"> </th> <th> </th> </tr> </thead> <tbody> <tr> <td>iv和序列化后的Info (usn,psd)</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>↓</td> <td style="text-align: left">-&gt;</td> <td>aes加密前的明文</td> </tr> <tr> <td>aes-128-cbc</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>↓</td> <td style="text-align: left">-&gt;</td> <td>aes加密后的密文</td> </tr> <tr> <td>base64</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>↓</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>赋值给cookie</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>…</td> <td style="text-align: left"> </td> <td> </td> </tr> </tbody> </table> <table> <thead> <tr> <th>check_login中</th> <th style="text-align: left"> </th> <th> </th> </tr> </thead> <tbody> <tr> <td>从cookie里读入’cipher’和’iv’  </td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>↓</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>base64解码</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>↓</td> <td style="text-align: left">-&gt;</td> <td>aes解密前的密文</td> </tr> <tr> <td>aes解密</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>↓</td> <td style="text-align: left">-&gt;</td> <td>aes解密后的明文</td> </tr> <tr> <td>反序列化</td> <td style="text-align: left"> </td> <td> </td> </tr> <tr> <td>…</td> <td style="text-align: left"> </td> <td> </td> </tr> </tbody> </table> <p>我们的CBC字符翻转攻击就是在上表倒数第四列用的。</p> <p>直接上脚本</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -*- coding:utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">unquote</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">quote_plus</span>

<span class="n">bs</span> <span class="o">=</span> <span class="s">'J67IvH4OY9t6QfcCP4Mp88bRfPKdsYszlev3LNbgPQ872VR633trbWfCqhcDYm6c3Eysp36W2SFkx4CPBX9nDQ</span><span class="si">%3</span><span class="s">D</span><span class="si">%3</span><span class="s">D'</span>
<span class="c">#密文cipher，从Chrome的插件EditThisCookie可以很轻松get到</span>
<span class="n">bs</span> <span class="o">=</span> <span class="n">unquote</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
<span class="c">#url解码</span>
<span class="n">bs_de</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
<span class="c">#base64解码</span>

<span class="n">ch</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">bs_de</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'2'</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'n'</span><span class="p">))</span>
<span class="n">bs_de</span><span class="o">=</span><span class="n">bs_de</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">+</span><span class="n">ch</span><span class="o">+</span><span class="n">bs_de</span><span class="p">[</span><span class="mi">14</span><span class="p">::]</span>
<span class="c">#其实就是bs_de[13]=chr(ord(bs_de[13]) ^ ord('2') ^ ord('n'))</span>
<span class="c">#因为python里面字符串不可变，即你直接bs_de = 'a'这样会报错</span>

<span class="n">rs</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">bs_de</span><span class="p">)</span>
<span class="c">#print rs</span>
<span class="k">print</span> <span class="n">quote_plus</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>

</code></pre></div></div> <p>我们在最开始的页面，第一行填admi2，第二行碰都不要碰（它会自动帮你填充Password，如果你点击了一下Password就<del>gg</del>为空了）</p> <p>进去之后使用Chrome的插件EditThisCookie，把cipher的值赋给脚本中的bs <img src="http://chuantu.biz/t6/293/1524487870x-1566661211.png" alt=""> 运行后，脚本返回修改了第一个密文分组的值的密文，当然它还经过了base64编码和urlencode <img src="http://chuantu.biz/t6/293/1524487923x-1566661211.png" alt=""> 我们把这堆东西贴到cipher那，然后按 <img src="http://chuantu.biz/t6/293/1524487979x-1566661211.png" alt=""> 绿色这个勾保存，然后在回车栏按enter</p> <p>注意：不要按刷新，因为刷新的话会<del>gg</del>重新提交表格，也就是之前post的username和password会重新提交，password不为空我们就又进去login而进不去check_login了，而我们直接回车栏enter是不会post东西的，但是cookie已经被我们改了。</p> <p>然后它返回个错误，说反序列化失败 <img src="http://chuantu.biz/t6/293/1524488038x-1566661211.png" alt=""> 这是当然的，因为我们把第一组的密文改了，第一组解密之后又不是原来的那个字符串，当然反序列化失败。</p> <p>我们把这串东西base64解密一下看看 <img src="http://chuantu.biz/t6/293/1524488056x-1566661211.png" alt=""> 我们看到，我们已经成功地把admi2变成admin了</p> <p>所以下一步我们就要用相同的套路，来复原第一个密文分组，也就是初始向量。</p> <p>还记得我之前提到的吗？</p> <p>把上一分组对应的密文 变成 密文 ⊕ 我们要改掉的 ⊕ 我们要改成的</p> <p>我还说过，密文是什么？ C0 = IV C1 = EK(Z1) C2 = EK(Z2) 所以我们要第一个分组的明文，当然就要对C0 = IV下手了</p> <p>原理和第一关一样，直接我们第二个脚本</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -*- coding:utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">unquote</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">quote_plus</span>

<span class="n">mingwen_de</span><span class="o">=</span><span class="s">'nj7W9vwn0gxyOdX3xUN/lG1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjg6IlBhc3N3b3JkIjt9'</span>
<span class="c">#base64_decode('这里面的') can't unserialize</span>
<span class="n">mingwen</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">mingwen_de</span><span class="p">)</span>
<span class="k">print</span> <span class="n">mingwen</span>

<span class="n">iv</span> <span class="o">=</span> <span class="s">'cFDYuzPtN1Q5ETd1E7s1Zw</span><span class="si">%3</span><span class="s">D</span><span class="si">%3</span><span class="s">D'</span>
<span class="c">#此时cookie里的iv</span>
<span class="n">iv</span> <span class="o">=</span> <span class="n">unquote</span><span class="p">(</span><span class="n">iv</span><span class="p">)</span>
<span class="n">iv_de</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">iv</span><span class="p">)</span>
<span class="n">new</span> <span class="o">=</span> <span class="s">'a:2:{s:8:"userna'</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">iv_de</span> <span class="o">=</span> <span class="n">iv_de</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">iv_de</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">mingwen</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="n">iv_de</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
<span class="c">#iv_de[i]=chr(ord(iv_de[i]) ^ ord(mingwen[i]) ^ ord(new[i]))</span>

<span class="k">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">iv_de</span><span class="p">))</span>
<span class="c">#用这个结果把原来的iv换掉</span>

</code></pre></div></div> <p>主要就是</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">iv_de</span> <span class="o">=</span> <span class="n">iv_de</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">iv_de</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">mingwen</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="n">iv_de</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>

</code></pre></div></div> <p>也就是</p> <p><code class="highlighter-rouge">iv_de[i]=chr(ord(iv_de[i]) ^ ord(mingwen[i]) ^ ord(new[i]))</code></p> <p>i遍历第一个分组的所有字符</p> <p>搞这么复杂的原因在cbc1.py的注释有提到，因为python不给我们直接改字符串</p> <p>这其中，iv_de就是IV，mingwen就是当前它解密出来的明文，也就是我们要改的，new是正确的明文，就是我们想要改变的</p> <p>这一点满足我之前说的</p> <p><strong>密文 = 密文 ⊕ 我们要改掉的 ⊕ 我们要改成的</strong></p> <p>这个脚本运行出来的东西就是我们改变后的IV的密文，再base64一下urlencode一下，然后把当前的IV换成这个，然后刷新或者地址栏回车都可以（因为上一次操作并没有携带post的内容），然后我们就能get flag了</p> <hr> <p><strong>最后再啰嗦一次，这道题怎么做呢？</strong></p> <p>打开bugku</p> <p><del>然后SourceLeakHacker 把index.php.swp扫出来</del></p> <p><del>然后vi -r index.php.swp 还原出php文件</del></p> <p><del>然后代码审计</del></p> <p><del>然后</del>在登录页面的第一个框输入admi2，第二个框不要碰</p> <p>然后我们打开EditThisCookie，把cipher的值赋给脚本cbc1.py中的bs，运行</p> <p>把运行结果赋值给cookie中的cipher，地址栏按回车</p> <p>把页面出现的base64_decode(‘这里面的’) can’t unserialize，单引号中的那个字符串，赋值给脚本cbc2.py中的mingwen_de</p> <p>打开EditThisCookie，把iv的值赋给脚本cbc2.py中的iv</p> <p>用运行脚本后得到的第二个字符串，替换掉cookie里的iv</p> <p>刷新，get flag</p> <hr> <p><strong>最后,欢迎交流 :D</strong></p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#CBC%20%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB" title="Pages tagged CBC 字节翻转攻击" class="tag"><span class="term">CBC 字节翻转攻击</span></a><a href="http://localhost:4000/tags/#bugku" title="Pages tagged bugku" class="tag"><span class="term">bugku</span></a><a href="http://localhost:4000/tags/#web" title="Pages tagged web" class="tag"><span class="term">web</span></a><a href="http://localhost:4000/tags/#Crypto" title="Pages tagged Crypto" class="tag"><span class="term">Crypto</span></a><a href="http://localhost:4000/tags/#CTF" title="Pages tagged CTF" class="tag"><span class="term">CTF</span></a><a href="http://localhost:4000/tags/#Write%20up" title="Pages tagged Write up" class="tag"><span class="term">Write up</span></a><a href="http://localhost:4000/tags/#%E4%B8%89%E6%96%87%E9%B1%BC" title="Pages tagged 三文鱼" class="tag"><span class="term">三文鱼</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/bugku-web-login4-WP/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/bugku-web-login4-WP/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/bugku-web-login4-WP/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'rhy7hm'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
